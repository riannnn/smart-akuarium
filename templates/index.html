<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Smart Aquarium</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
  </head>

  <div id="toast-container"></div>
  <script>
    const flashMessages = {{ get_flashed_messages() | tojson | safe }};
  </script>

  <body class="index-page">
    <nav>
      <div class="nav-brand">Smart Aquarium</div>
      <div class="nav-actions">
        {% if username %}
        <span class="user-greeting">Hi, {{ username }}</span>
        <a href="{{ url_for('logout') }}" class="btn-logout">Logout</a>
        {% else %}
        <button id="openLoginBtn" class="btn-login">Login</button>
        <button id="openRegisterBtn" class="btn-register">Register</button>
        {% endif %}
      </div>
    </nav>

    <main class="hero-section">
      <div class="hero-content">
        <h1>Total Dissolved Solids<br />Angle Fish Monitoring</h1>
        <div class="hero-buttons">
          <a
            href="{{ url_for('monitoring') }}"
            class="btn-choice"
            data-protected="true"
            >Monitoring</a
          >
          <a
            href="{{ url_for('history') }}"
            class="btn-choice"
            data-protected="true"
            >History</a
          >
        </div>
      </div>
    </main>

    <footer>
      &copy; 2025 Febriansyah â€” Universitas Muhammadiyah Prof. Dr. Hamka
    </footer>

    <div class="modal-overlay" id="modalOverlay">
      <div class="modal">
        <button class="close-btn" id="closeModalBtn">&times;</button>
        <div class="tabs">
          <span class="tab active" id="tabLogin">Login</span>
          <span class="tab" id="tabRegister">Register</span>
        </div>

        <!-- Login Form -->
        <form
          id="loginForm"
          method="POST"
          action="{{ url_for('login') }}"
          autocomplete="off"
        >
          <h2>Login</h2>
          <div class="password-wrapper">
            <input
              type="text"
              name="username"
              placeholder="Username"
              autocomplete="off"
              required
            />
          </div>
          <div class="password-wrapper">
            <input
              type="password"
              id="loginPassword"
              name="password"
              placeholder="Password"
              autocomplete="new-password"
              required
            />
            <span class="toggle-password" data-target="loginPassword"
              >&#128065;</span
            >
          </div>
          <button type="submit">Login</button>
        </form>

        <!-- Register Form -->
        <form
          id="register_user"
          method="POST"
          action="{{ url_for('register_user') }}"
          style="display: none"
          autocomplete="off"
        >
          <h2>Register</h2>
          <input
            type="text"
            name="username"
            placeholder="Username"
            autocomplete="off"
            required
          />
          <input
            type="email"
            name="email"
            placeholder="Email"
            autocomplete="off"
            required
          />
          <div class="password-wrapper">
            <input
              type="password"
              id="password"
              name="password"
              placeholder="Password"
              autocomplete="new-password"
              required
            />
            <span class="toggle-password" data-target="password"
              >&#128065;</span
            >
          </div>
          <div class="password-wrapper">
            <input
              type="password"
              id="confirmPassword"
              name="confirmPassword"
              placeholder="Konfirmasi Password"
              autocomplete="new-password"
              required
            />
            <span class="toggle-password" data-target="confirmPassword"
              >&#128065;</span
            >
          </div>
          <p
            id="passwordError"
            style="color: red; font-size: 0.9em; margin-top: 5px; display: none"
          >
            Konfirmasi password tidak sesuai!
          </p>
          <button type="submit" id="registerButton">Register</button>
        </form>
      </div>
    </div>

    <script>
      window.isLoggedIn = {{ 'true' if username else 'false' }};
    </script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
  </body>
</html>
